<div class="catalogo-container">
  <h2 class="titulo">Selección de un vehículo</h2>

  <div class="filtros">
    <!-- Filtros principales por tipo -->
    <ng-container *ngFor="let tipo of tiposVehiculo">
      <button class="filtro"
              [ngClass]="{ activo: filtrosActivos.includes('tipo:' + tipo) }"
              (click)="toggleFiltro('tipo:' + tipo)">
        {{ tipo | titlecase }}
      </button>
    </ng-container>

    <!-- Filtro general -->
    <button class="filtro"
            [ngClass]="{ activo: filtrosActivos.includes('Todos los vehículos') }"
            (click)="toggleFiltro('Todos los vehículos')">
      Todos los vehículos
    </button>

    <!-- Botón para limpiar -->
    <button class="filtro" (click)="limpiarFiltros()">
      Limpiar filtros
    </button>

    <!-- Filtros desplegables -->
    <ng-container *ngFor="let filtro of dropdownKeys">
      <div class="filtro-dropdown">
        <button class="filtro"
                [ngClass]="{ activo: isFiltroDropdownActivo(filtro) }"
                (click)="toggleDropdown(filtro)">
          {{ filtro | titlecase }}
          <span *ngIf="getCantidadSeleccionados(filtro) > 0" class="contador">
            ({{ getCantidadSeleccionados(filtro) }})
          </span>
        </button>
        <div class="dropdown-opciones" *ngIf="dropdowns[filtro]">
          <button
            *ngFor="let opcion of getOpcionesFiltro(filtro)"
            (click)="seleccionarFiltro(filtro, opcion)"
            [ngClass]="{ activo: filtrosActivos.includes(filtro + ':' + opcion) }">
            {{ opcion | titlecase }}
          </button>
        </div>
      </div>
    </ng-container>
  </div>

  <div class="grid-vehiculos">
    <div class="tarjeta-vehiculo" *ngFor="let vehiculo of vehiculosFiltrados">
      <div class="imagen-vehiculo">
        <img [src]="vehiculo.imagen" [alt]="vehiculo.modelo">
      </div>
      <div class="info-vehiculo">
        <div class="nombre-precio-vehiculo">
          <div class="nombre-vehiculo">
            <h3>{{ vehiculo.marca }}</h3>
            <p>{{ vehiculo.modelo }}</p>
            <p class="anio">{{ vehiculo.anio }}</p>
          </div>
          <div class="precio">
            <span class="cantidad">€{{ vehiculo.precio }}</span>
            <span class="por-dia">por día</span>
          </div>
        </div>
        <div class="caracteristicas-vehiculo">
          <div class="caracteristica">
            <i [ngClass]="vehiculo.transmision === 'MANUAL' ? 'fas fa-cog' : 'fas fa-car'"></i>
            <span>{{ vehiculo.transmision | titlecase }}</span>
          </div>
          <div class="caracteristica">
            <i [ngClass]="{
              'fas fa-gas-pump': vehiculo.combustible === 'GASOLINA' || vehiculo.combustible === 'GLP',
              'fas fa-industry': vehiculo.combustible === 'DIESEL',
              'fas fa-bolt': vehiculo.combustible === 'ELECTRICO'
            }"></i>
            <span>{{ vehiculo.combustible | titlecase }}</span>
          </div>
          <div class="caracteristica">
            <i class="fas fa-snowflake"></i>
            <span *ngIf="vehiculo.aireAcondicionado">A/A</span>
            <span *ngIf="!vehiculo.aireAcondicionado">Sin A/A</span>
          </div>
        </div>
        <button class="boton-detalles" (click)="openespecidicaciones(vehiculo.matricula)">Ver detalles</button>
      </div>
    </div>
  </div>
</div>
